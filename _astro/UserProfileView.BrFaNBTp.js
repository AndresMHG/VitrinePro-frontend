import{_ as U,i as V,g as b,b as x,c as T,d as E,e as L}from"./_plugin-vue_export-helper.D3-yg2xa.js";/* empty css                              */import{d as z,c as r,a as e,b as k,e as C,t,r as l,f as B,o as n}from"./runtime-core.esm-bundler.CbHwxXao.js";const D=z({__name:"UserProfileView",setup(w,{expose:o}){o();const f=l(null),s=l(""),d=l(!1),i=l(!0),v=l(!1),_=l(!1),g=l(!1),c=l(""),h=l("");function P(a,u){return`${a.charAt(0)}${u.charAt(0)}`.toUpperCase()}function A(){_.value=!_.value}async function M(){try{await navigator.clipboard.writeText(s.value),g.value=!0,setTimeout(()=>{g.value=!1},2e3)}catch{c.value="Error al copiar el token"}}async function m(){try{if(i.value=!0,c.value="",typeof window>"u"){i.value=!1;return}if(!V()){d.value=!1,i.value=!1;return}d.value=!0;const a=b(),u=x();if(!a||!u){d.value=!1,i.value=!1;return}try{const y=await T(a);f.value=y.user,s.value=a}catch{f.value=u,s.value=a,c.value="Información del perfil cargada desde caché",console.log("Error al obtener perfil del API, usando datos en caché")}}catch(a){console.error("Error loading profile:",a),c.value="Error al cargar el perfil"}finally{i.value=!1}}async function N(){try{v.value=!0,c.value="",h.value="";const a=b();if(!a){d.value=!1;return}const u=await T(a);f.value=u.user,h.value="Perfil actualizado correctamente"}catch{c.value="Error al actualizar el perfil"}finally{v.value=!1}}function I(){E(),L(),window.location.href="/VitrinePro-frontend/login"}B(()=>{m()});const p={user:f,token:s,isAuthenticated:d,isLoading:i,isRefreshing:v,showToken:_,tokenCopied:g,errorMessage:c,successMessage:h,getInitials:P,toggleTokenVisibility:A,copyToken:M,loadProfile:m,refreshProfile:N,handleLogout:I};return Object.defineProperty(p,"__isScriptSetup",{enumerable:!1,value:!0}),p}}),S={class:"profile-container"},O={key:0,class:"alert alert-warning"},R={key:1,class:"loading"},j={key:2,class:"profile-content"},q={class:"user-card"},F={class:"user-info"},G={class:"user-avatar"},H={class:"user-details"},J={class:"email"},K={class:"user-id"},Q={class:"token-section"},W={class:"section-header"},X={class:"token-content"},Y={key:0,class:"token-display"},Z={class:"token-code"},$={key:1,class:"token-hidden"},ee={class:"data-section"},se={class:"data-grid"},oe={class:"data-item"},te={class:"data-item"},ae={class:"data-item"},re={class:"data-item"},ne={class:"code-text"},le={class:"actions-section"},ie={key:0},ce={key:1},de={key:0,class:"alert alert-error"},ue={key:1,class:"alert alert-success"},fe={key:3,class:"alert alert-error"};function ve(w,o,f,s,d,i){return n(),r("div",S,[e("div",{class:"profile-header"},[o[0]||(o[0]=e("h1",null,"Mi Perfil",-1)),e("button",{onClick:s.handleLogout,class:"btn-logout"},"Cerrar sesión")]),s.isAuthenticated?s.isLoading?(n(),r("div",R,[...o[2]||(o[2]=[e("p",null,"Cargando tu perfil...",-1)])])):s.user?(n(),r("div",j,[e("div",q,[e("div",F,[e("div",G,t(s.getInitials(s.user.firstName,s.user.lastName)),1),e("div",H,[e("h2",null,t(s.user.firstName)+" "+t(s.user.lastName),1),e("p",J,t(s.user.email),1),e("p",K,"ID: "+t(s.user.id),1)])])]),e("div",Q,[e("div",W,[o[3]||(o[3]=e("h3",null,"Access Token",-1)),e("button",{onClick:s.toggleTokenVisibility,class:"btn-toggle"},t(s.showToken?"Ocultar":"Mostrar"),1)]),e("div",X,[s.showToken?(n(),r("div",Y,[e("code",Z,t(s.token),1),e("button",{onClick:s.copyToken,class:"btn-copy"},t(s.tokenCopied?"¡Copiado!":"Copiar"),1)])):(n(),r("div",$,[...o[4]||(o[4]=[e("p",null,"Token oculto por seguridad",-1)])]))])]),e("div",ee,[o[9]||(o[9]=e("h3",null,"Información del Usuario",-1)),e("div",se,[e("div",oe,[o[5]||(o[5]=e("label",null,"Nombre",-1)),e("p",null,t(s.user.firstName),1)]),e("div",te,[o[6]||(o[6]=e("label",null,"Apellido",-1)),e("p",null,t(s.user.lastName),1)]),e("div",ae,[o[7]||(o[7]=e("label",null,"Email",-1)),e("p",null,t(s.user.email),1)]),e("div",re,[o[8]||(o[8]=e("label",null,"ID de Usuario",-1)),e("p",ne,t(s.user.id),1)])])]),e("div",le,[e("button",{onClick:s.refreshProfile,class:"btn btn-secondary"},[s.isRefreshing?(n(),r("span",ce,"Actualizando...")):(n(),r("span",ie,"Actualizar Perfil"))]),e("button",{onClick:s.handleLogout,class:"btn btn-danger"},"Cerrar sesión")]),s.errorMessage?(n(),r("div",de,t(s.errorMessage),1)):k("",!0),s.successMessage?(n(),r("div",ue,t(s.successMessage),1)):k("",!0)])):s.errorMessage?(n(),r("div",fe,t(s.errorMessage),1)):k("",!0):(n(),r("div",O,[...o[1]||(o[1]=[e("p",null,[C("No estás autenticado. Por favor "),e("a",{href:"/login"},"inicia sesión"),C(" para ver tu perfil.")],-1)])]))])}const ke=U(D,[["render",ve],["__scopeId","data-v-32748231"]]);export{ke as default};
